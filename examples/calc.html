<!doctype html>
<html>
<head>
  <title>spreadsheet component</title>
  <link rel="stylesheet" href="../build/build.css">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <style>
    table {
      /*border-collapse: collapse;*/
    }


    table td {
      /*border: 1px solid #ccc;*/
      padding: 5px;
    }

    table th {
      max-width: 30px;
    }

    .header {
      font-weight: normal;
      font-style: italic;
    }

    table th,
    table tr {
      -webkit-transition: all ease-out .7s;
      -moz-transition: all ease-out .7s;
      -ms-transition: all ease-out .7s;
      -o-transition: all ease-out .7s;
      transition: all ease-out .7s;
    }

  </style>
</head>
<body>
  <h1>Calculations</h1>
  <script src="../build/build.js" type="text/javascript"></script>
  <script type="text/javascript">
    var domify = require('domify');
    var Spreadsheet = require('spreadsheet');
    console.time('draw');
    var spreadsheet = Spreadsheet('Q137');
    console.timeEnd('draw');

    document.body.appendChild(spreadsheet.el);
    window.spreadsheet = spreadsheet;
    
    spreadsheet.classes.add('headings');

    var s = spreadsheet
      .select('A2:A9').insert(years([1, 2, 3, 4, 5, 6, 7, 8])).addClass('header')
      .select('B, C').each(function(cell) {
        cell.val(~~(Math.random() * 100))
      })
      console.time('calcs');
      s.select('D').calc('{B} - {C}').format('$')
      s.select('E').calc('{D} + 100').format('$')
      console.timeEnd('calcs');
      s.select('B1, C1, D1, E1').insert(['Revenues', 'Expenses', 'Profit', 'Total']).addClass('header')
      // .select('B2:B9').insert([10, 12, 32, 43, 53, 23, 32, 43]).format('$').editable()
      // .select('C2:C9').insert([32, 11, 22, 33, 45, 42, 10, 32]).format('$').editable()


    function years(arr) {
      return arr.map(function(item) {
        return 'Year ' + item;
      })
    }

    // var el = spreadsheet.el;
    // var tr = el.querySelector('thead tr:first-of-type');
    // var rowhead = tr.querySelector('.rowhead');
    // var layer = domify('<th class = "layer"></th>')
    // tr.insertBefore(layer, rowhead.nextSibling);

  </script>
</body>
</html>
