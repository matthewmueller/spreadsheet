<!doctype html>
<html>
<head>
  <title>spreadsheet component</title>
  <link rel="stylesheet" href="../build/build.css">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <style>
    .spreadsheet {
      margin: 0 auto;
      max-width: 1000px;
    }
    table {
      /*border-collapse: collapse;*/
      font-size: 7.5pt;
      text-align: right;

    }

    table .headers {
      text-align: left;
    }


    table td {
      /*border: 1px solid #ccc;*/
      padding: 5px;
    }

    table th {
      max-width: 60px;
    }

    .header {
      font-weight: normal;
      font-style: italic;
      font-family: Arial;

    }

    .col-merge {
      text-align: center;
      font-weight: bold;
      border-bottom: solid black 1px !important;
    }

    .rating {
      text-align: center;
      font-weight: bold;
      color: green !important;
    }

    .totals {
      font-weight: bold;
    }

    .permanent-hide {
      display: none;
    }

    .whiteout {
      color: white !important;
    }

    .spacer {
      height: 1px !important;
    }

    .input-heading {
      background-color: #f2f2f2;
      font-weight: bold;
      text-align: center;
    }

    .red-titles {
      color: red;
    }

    .titles {
      font-weight: bold;
      text-align: center;
    }

    .total_border {
      border-top: solid black 1px !important;
      border-bottom: solid black 1px !important;
    }


  </style>
</head>
<body>
  <h1 style="font-family:verdana; font-size:10pt">LR Model Template</h1>
  <script src="../build/build.js" type="text/javascript"></script>
  <script type="text/javascript">

  var Spreadsheet = require('spreadsheet');
  var spreadsheet = window.spreadsheet = Spreadsheet('Q151').addClass('headings');
  document.body.appendChild(spreadsheet.el);


    // ***********************************************************
    // Input Assumptions
    // ***********************************************************

    //Paste
    // inputs
    var company_name = "McDonald's Corp.";
    var valuation_date = 41793;

    var trading_price = 101.45;

    var EBITDA_exit = 11;
    var rev_exit = 3.95;
    var growth_exit = 0.03;
    var pe_exit = 18.69;

    var discount_rate = 0.075;
    var equity_discount_rate = 0.085;

    // balance sheet inputs
    var debt = 13926.8;
    var interest_rate = 0.039;
    var tax_rate = 0.32;
    var dep_prior_ppe = 0.062;
    var latest_nwc = 75.3000000000002;
    var fiscal_year_end_nwc = -98.3999999999999;
    //[(-) Unconsolidated Investments, (-) Deferred Revenue Cash Adjustment, (+/-) Other, (+) Non-Controlling Interests, (+) Debt, (-) Cash]
    var equity_waterfall = [1223.8, 0, -22.8499999999998, 0, -13926.8, 2743.8];
    var shares_outstanding = 999.869424872523;

    var change_in_ltm_nwc = 266.2;
    var change_in_ytd_nwc = -173.7;
    var avg_nwc = 0.003;
    var fy_ppe = 25747.3;


    // enter excel dates
    // [LTM, FY+1, FY+2, FY+3, FY+4, FY+5]
    var ltm_num_dates = 41729;
    var proj_num_dates = [42004, 42369, 42735, 43100, 43465];


    // enter text dates
    var hist_text_dates = ['Dec-09', 'Dec-10', 'Dec-11', 'Dec-12', 'Dec-13', '', 'Mar-13', 'Mar-14', 'Mar-14'];
    var proj_text_dates = ['Dec-14', 'Dec-15', 'Dec-16', 'Dec-17', 'Dec-18'];


    // enter text periods
    var hist_period_text_dates = ['FY 09', 'FY 10', 'FY 11', 'FY 12', 'FY 13', '', 'YTD Prior', 'YTD', 'LTM'];
    var proj_period_text_dates = ['FY 14', 'FY 15', 'FY 16', 'FY 17', 'FY 18'];


    // income statement inputs
    var rev_title_1 = "   United States (U.S.)";
    var rev_title_2 = "   Europe";
    var rev_title_3 = "   Asia/Pacific, Middle East and Africa (APMEA)";
    var rev_title_4 = "   Other Countries & Corporate";
    var rev_title_5 = "   Segment 5";
    var rev_title_6 = "   Segment 6";
    var rev_title_7 = "   Segment 7";


    // historical revenue growth by segment
      // [FY-4, FY-3, FY-2, FY-1, FY, YTD Prior Prior, YTD Prior, YTD]
    var hist_rev_fin_1 = [7943.8, 8111.6, 8528.2, 8813.7, 8851.3, 2102.3, 2088.5, 2054.1];
    var hist_rev_fin_2 = [9273.8, 9569.2, 10886.4, 10827.4, 11299.8, 2535.5, 2586.4, 2712.2];
    var hist_rev_fin_3 = [4337, 5065.5, 6019.5, 6391.1, 6477.2, 1556.6, 1593.7, 1618.8];
    var hist_rev_fin_4 = [1190.1, 1328.3, 1571.9, 1534.8, 1477.4, 352.2, 336.7, 315.2];
    var hist_rev_fin_5 = [0, 0, 0, 0, 0, 0, 0, 0];
    var hist_rev_fin_6 = [0, 0, 0, 0, 0, 0, 0, 0];
    var hist_rev_fin_7 = [0, 0, 0, 0, 0, 0, 0, 0];


    // historical cogs, sg&a, d&a, and capex
    var hist_cogs_fin = [-12651.2, -13059.5, -14837.9, -15223.7, -15578.6, '', -3726, -3767.1];
    var hist_sga_fin = [-3535.9, -3711.1, -3875.2, -3982.2, -4010, '', -991.7, -1037.5];
    var hist_da_fin = [1216.2, 1276.2, 1415, 1488.5, 1585.1, '', 391.1, 410.4];


    // ytd [dep, amort]
    var hist_ltm_da = [-1518.1, -86.3];
    var hist_ytd_da = [-388.825, -21.575];
    var hist_capex_fin = [1952.1, 2135.5, 2729.8, 3049.2, 2824.7, '', 634.2, 568.8];


    // all segments
    var ytd_prior_rev_growth = [-0.0066, 0.0201, 0.0238, -0.044, 0, 0, 0, 0.009];
    var ltm_rev_growth = [0.0019, 0.0503, 0.0115, -0.0417, 0, 0, 0, 0.0208];


    // interest expense
    var ltm_interest_exp = -528.8;
    var ytd_interest_exp = -135;

      // projected inputs
      var proj_rev_growth_1 = [0.006, 0.006, 0.006, 0.006, 0.006];
      var proj_rev_growth_2 = [0.05, 0.05, 0.05, 0.05, 0.05];
      var proj_rev_growth_3 = [0.042, 0.042, 0.042, 0.042, 0.042];
      var proj_rev_growth_4 = [-0.007, -0.007, -0.007, -0.007, -0.007];
      var proj_rev_growth_5 = [0, 0, 0, 0, 0];
      var proj_rev_growth_6 = [0, 0, 0, 0, 0];
      var proj_rev_growth_7 = [0, 0, 0, 0, 0];

      var proj_seg_rev_growth = [proj_rev_growth_1, proj_rev_growth_2, proj_rev_growth_3, proj_rev_growth_4, proj_rev_growth_5, proj_rev_growth_6, proj_rev_growth_7];

      var proj_total_rev_growth = [0.03098, 0.031, 0.032, 0.032, 0.033];
      var proj_gp_margin = [0.44619, 0.446, 0.446, 0.446, 0.446];
      var proj_sga_margin = [0.14373, 0.144, 0.144, 0.144, 0.144];
      var proj_ebit_margin = [0.30247, 0.302, 0.302, 0.302, 0.302];
      var proj_capex_margin = [0.09796, 0.098, 0.098, 0.098, 0.098];
      var proj_nwc = [0.00348, 0.003, 0.003, 0.003, 0.003];

    // ***********************************************************
    // Start Assumption Collection
    // ***********************************************************

    // column titles
    spreadsheet.select('A').width(200)
    spreadsheet.select('A1:A65').addClass('headers')
      .insert(['', 
               '', 
               '', 
               '', 
               '', 
               '',
               company_name + ' Model',
              '',
              'Growth Assumptions:',
              rev_title_1 + ' Growth',
              rev_title_2 + ' Growth',
              rev_title_3 + ' Growth',
              rev_title_4 + ' Growth',
              rev_title_5 + ' Growth',
              rev_title_6 + ' Growth',
              rev_title_7 + ' Growth',
              'Total Revenue Growth',
              '',
              'Implied Forecast:',
              '  '+rev_title_1,
              '  '+rev_title_2,                                
              '  '+rev_title_3,
              '  '+rev_title_4,
              '  '+rev_title_5,
              '  '+rev_title_6,
              '  '+rev_title_7,
              'Total Revenue',
              '  Growth',
              '',
              'Cost of Goods',
              '',
              'Gross Profit',
              '  GP Margin',
              '',
              'SG&A Expenses',
              '  % of Revenue',
              '',
              'EBIT',
              '  EBIT Margin',
              '',
              '(+) D&A',
              '',
              'EBITDA',
              '  EBITDA Margin',
              '',
              'Capital Expenditures',
              '  % of Revenue',
              '',
              'Stock Price Analysis',
              '',
              'Valuation Date',
              '',
              '5-Year Exit Method',
              '',
              'Use Method (Y to Use, N to Ignore)',
              '',
              'Exit in Year 5 at',
              'Assumed Discount Rate',
              'Implied Fair Value per Share',
              'Current Trading Price',
              'Discount/(Premium) to Current Price',
              'Average Discount / (Premium)',
              '',
              'Your Rating',
              ''])

    spreadsheet.select('A1:P1').insert(['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I',
                                        'J', 'K', 'L', 'M', 'N', 'O', 'P'])

    // merged rows
    // spreadsheet.select('B4:J4').merge().insert(['Historical Financials']).addClass('col-merge')
    spreadsheet.select('L4:P4').merge().insert(['Input Projections']).addClass('col-merge')

    // historical date titles
      // excel number of days entered
    spreadsheet.select('J5').insert(ltm_num_dates)
    spreadsheet.select('L5:P5').insert(proj_num_dates)

      // text date format entered
    spreadsheet.select('B6:J6').insert(hist_text_dates)
    spreadsheet.select('L6:P6').insert(proj_text_dates)

      // text period format entered
    spreadsheet.select('B7:J7').insert(hist_period_text_dates)
    spreadsheet.select('L7:P7').insert(proj_period_text_dates)

    // revenue input historical
    spreadsheet.select('B20:I20').insert(hist_rev_fin_1).format('$')
    spreadsheet.select('B21:I21').insert(hist_rev_fin_2).format('#')
    spreadsheet.select('B22:I22').insert(hist_rev_fin_3).format('#')
    spreadsheet.select('B23:I23').insert(hist_rev_fin_4).format('#')
    spreadsheet.select('B24:I24').insert(hist_rev_fin_5).format('#')
    spreadsheet.select('B25:I25').insert(hist_rev_fin_6).format('#')
    spreadsheet.select('B26:I26').insert(hist_rev_fin_7).format('#')
    spreadsheet.select('J20').calc('{I} + {F} - {H}').format('$')
    spreadsheet.select('J21:J26').calc('{I} + {F} - {H}').format('#')
    
    // revenue totals sum historical
    spreadsheet.select('B27:J27').calc('{20} + {21} + {22} + {23} + {24} + {25} + {26}').format('$')

    // segment and total growth calculate historical
    // spreadsheet.select('C10').calc('{C20} / {B20} - 1').format('%')
    // spreadsheet.select('C11').calc('{C21} / {B21} - 1').format('%')
    // spreadsheet.select('C12').calc('{C22} / {B22} - 1').format('%')
    // spreadsheet.select('C13').calc('{C23} / {B23} - 1').format('%')
    // spreadsheet.select('C14').calc('{C24} / {B24} - 1').format('%')
    // spreadsheet.select('C15').calc('{C25} / {B25} - 1').format('%')
    // spreadsheet.select('C16').calc('{C26} / {B26} - 1').format('%')
    // spreadsheet.select('C17').calc('{C27} / {B27} - 1').format('%')

    // spreadsheet.select('D10').calc('{D20} / {C20} - 1').format('%')
    // spreadsheet.select('D11').calc('{D21} / {C21} - 1').format('%')
    // spreadsheet.select('D12').calc('{D22} / {C22} - 1').format('%')
    // spreadsheet.select('D13').calc('{D23} / {C23} - 1').format('%')
    // spreadsheet.select('D14').calc('{D24} / {C24} - 1').format('%')
    // spreadsheet.select('D15').calc('{D25} / {C25} - 1').format('%')
    // spreadsheet.select('D16').calc('{D26} / {C26} - 1').format('%')
    // spreadsheet.select('D17').calc('{D27} / {C27} - 1').format('%')

    // spreadsheet.select('E10').calc('{E20} / {D20} - 1').format('%')
    // spreadsheet.select('E11').calc('{E21} / {D21} - 1').format('%')
    // spreadsheet.select('E12').calc('{E22} / {D22} - 1').format('%')
    // spreadsheet.select('E13').calc('{E23} / {D23} - 1').format('%')
    // spreadsheet.select('E14').calc('{E24} / {D24} - 1').format('%')
    // spreadsheet.select('E15').calc('{E25} / {D25} - 1').format('%')
    // spreadsheet.select('E16').calc('{E26} / {D26} - 1').format('%')
    // spreadsheet.select('E17').calc('{E27} / {D27} - 1').format('%')

    // spreadsheet.select('F10').calc('{F20} / {E20} - 1').format('%')
    // spreadsheet.select('F11').calc('{F21} / {E21} - 1').format('%')
    // spreadsheet.select('F12').calc('{F22} / {E22} - 1').format('%')
    // spreadsheet.select('F13').calc('{F23} / {E23} - 1').format('%')
    // spreadsheet.select('F14').calc('{F24} / {E24} - 1').format('%')
    // spreadsheet.select('F15').calc('{F25} / {E25} - 1').format('%')
    // spreadsheet.select('F16').calc('{F26} / {E26} - 1').format('%')
    // spreadsheet.select('F17').calc('{F27} / {E27} - 1').format('%')

    // spreadsheet.select('H10:H17').insert(ytd_prior_rev_growth).format('%')
    // spreadsheet.select('H28').insert(ytd_prior_rev_growth[ytd_prior_rev_growth.length-1]).format('%')

    // spreadsheet.select('I10').calc('{I20} / {H20} - 1').format('%')
    // spreadsheet.select('I11').calc('{I21} / {H21} - 1').format('%')
    // spreadsheet.select('I12').calc('{I22} / {H22} - 1').format('%')
    // spreadsheet.select('I13').calc('{I23} / {H23} - 1').format('%')
    // spreadsheet.select('I14').calc('{I24} / {H24} - 1').format('%')
    // spreadsheet.select('I15').calc('{I25} / {H25} - 1').format('%')
    // spreadsheet.select('I16').calc('{I26} / {H26} - 1').format('%')
    // spreadsheet.select('I17').calc('{I27} / {H27} - 1').format('%')

    // spreadsheet.select('J10:J17').insert(ltm_rev_growth).format('%')

    // // total revenue growth rates below
    // spreadsheet.select('C28').calc('{C27} / {B27} - 1').format('%')
    // spreadsheet.select('D28').calc('{D27} / {C27} - 1').format('%')
    // spreadsheet.select('E28').calc('{E27} / {D27} - 1').format('%')
    spreadsheet.select('F28').calc('{F27} / {E27} - 1').format('%')
    // spreadsheet.select('I28').calc('{I27} / {H27} - 1').format('%')
    spreadsheet.select('J28').insert(ltm_rev_growth[ltm_rev_growth.length-1]).format('%')

    // //// projected revenue inputs
    //   spreadsheet.select('L10:P10').insert(proj_seg_rev_growth[0]).editable().format('%')
    //   spreadsheet.select('L11:P11').insert(proj_seg_rev_growth[1]).editable().format('%')
    //   spreadsheet.select('L12:P12').insert(proj_seg_rev_growth[2]).editable().format('%')
    //   spreadsheet.select('L13:P13').insert(proj_seg_rev_growth[3]).editable().format('%')
    //   spreadsheet.select('L14:P14').insert(proj_seg_rev_growth[4]).editable().format('%')
    //   spreadsheet.select('L15:P15').insert(proj_seg_rev_growth[5]).editable().format('%')
    //   spreadsheet.select('L16:P16').insert(proj_seg_rev_growth[6]).editable().format('%')
    //   spreadsheet.select('L17:P17').calc('{28}').format('%')

    //   spreadsheet.select('L20').calc('({L10}+1) * {F20}').format('$')
    //   spreadsheet.select('M20').calc('({M10}+1) * {L20}').format('$')
    //   spreadsheet.select('N20').calc('({N10}+1) * {M20}').format('$')
    //   spreadsheet.select('O20').calc('({O10}+1) * {N20}').format('$')
    //   spreadsheet.select('P20').calc('({P10}+1) * {O20}').format('$')

    //   spreadsheet.select('L21').calc('({L11}+1) * {F21}').format('#')
    //   spreadsheet.select('M21').calc('({M11}+1) * {L21}').format('#')
    //   spreadsheet.select('N21').calc('({N11}+1) * {M21}').format('#')
    //   spreadsheet.select('O21').calc('({O11}+1) * {N21}').format('#')
    //   spreadsheet.select('P21').calc('({P11}+1) * {O21}').format('#')

    //   spreadsheet.select('L22').calc('({L12}+1) * {F22}').format('#')
    //   spreadsheet.select('M22').calc('({M12}+1) * {L22}').format('#')
    //   spreadsheet.select('N22').calc('({N12}+1) * {M22}').format('#')
    //   spreadsheet.select('O22').calc('({O12}+1) * {N22}').format('#')
    //   spreadsheet.select('P22').calc('({P12}+1) * {O22}').format('#')

    //   spreadsheet.select('L23').calc('({L13}+1) * {F23}').format('#')
    //   spreadsheet.select('M23').calc('({M13}+1) * {L23}').format('#')
    //   spreadsheet.select('N23').calc('({N13}+1) * {M23}').format('#')
    //   spreadsheet.select('O23').calc('({O13}+1) * {N23}').format('#')
    //   spreadsheet.select('P23').calc('({P13}+1) * {O23}').format('#')

    //   spreadsheet.select('L24').calc('({L14}+1) * {F24}').format('#')
    //   spreadsheet.select('M24').calc('({M14}+1) * {L24}').format('#')
    //   spreadsheet.select('N24').calc('({N14}+1) * {M24}').format('#')
    //   spreadsheet.select('O24').calc('({O14}+1) * {N24}').format('#')
    //   spreadsheet.select('P24').calc('({P14}+1) * {O24}').format('#')

    //   spreadsheet.select('L25').calc('({L15}+1) * {F25}').format('#')
    //   spreadsheet.select('M25').calc('({M15}+1) * {L25}').format('#')
    //   spreadsheet.select('N25').calc('({N15}+1) * {M25}').format('#')
    //   spreadsheet.select('O25').calc('({O15}+1) * {N25}').format('#')
    //   spreadsheet.select('P25').calc('({P15}+1) * {O25}').format('#')

    //   spreadsheet.select('L26').calc('({L16}+1) * {F26}').format('#')
    //   spreadsheet.select('M26').calc('({M16}+1) * {L26}').format('#')
    //   spreadsheet.select('N26').calc('({N16}+1) * {M26}').format('#')
    //   spreadsheet.select('O26').calc('({O16}+1) * {N26}').format('#')
    //   spreadsheet.select('P26').calc('({P16}+1) * {O26}').format('#')

      spreadsheet.select('L28:P28').insert(proj_total_rev_growth).editable().format('%')

      spreadsheet.select('L27').calc('({L28}+1) * {F27}').format('$')
      spreadsheet.select('M27').calc('({M28}+1) * {L27}').format('$')
      spreadsheet.select('N27').calc('({N28}+1) * {M27}').format('$')
      spreadsheet.select('O27').calc('({O28}+1) * {N27}').format('$')
      spreadsheet.select('P27').calc('({P28}+1) * {O27}').format('$')

    // cogs
    spreadsheet.select('B30:I30').insert(hist_cogs_fin).format('#')
    spreadsheet.select('J30').calc('{F} + {I} - {H}').format('#')

    // //// projected cogs
    // spreadsheet.select('L30:P30').calc('{32} - {27}').format('#')

    // historical gp
    spreadsheet.select('B32:F32').calc('{27} + {30}').format('#')
    spreadsheet.select('H32:J32').calc('{27} + {30}').format('#')
    spreadsheet.select('B33:F33').calc('{32} / {27}').format('%')
    spreadsheet.select('H33:J33').calc('{32} / {27}').format('%')

    // //// projected gp inputs
    //   spreadsheet.select('L33:P33').insert(proj_gp_margin).editable().format('%')
    //   spreadsheet.select('L32').calc('{L27} * {L33}').format('#')
    //   spreadsheet.select('M32').calc('{M27} * {M33}').format('#')
    //   spreadsheet.select('N32').calc('{N27} * {N33}').format('#')
    //   spreadsheet.select('O32').calc('{O27} * {O33}').format('#')
    //   spreadsheet.select('P32').calc('{P27} * {P33}').format('#')


    // historical sga
    spreadsheet.select('B35:I35').insert(hist_sga_fin).format('#')
    spreadsheet.select('J35').calc('{F} + {I} - {H}').format('#')
    spreadsheet.select('B36:F36').calc('-{35} / {27}').format('%')
    spreadsheet.select('H36:J36').calc('-{35} / {27}').format('%')

    // //// projected sga inputs
    //   spreadsheet.select('L36:P36').insert(proj_sga_margin).editable().format('%')
    //   spreadsheet.select('L35').calc('-{L27} * {L36}').format('#')
    //   spreadsheet.select('M35').calc('-{M27} * {M36}').format('#')
    //   spreadsheet.select('N35').calc('-{N27} * {N36}').format('#')
    //   spreadsheet.select('O35').calc('-{O27} * {O36}').format('#')
    //   spreadsheet.select('P35').calc('-{P27} * {P36}').format('#')

    // historical ebit
    spreadsheet.select('B38:F38').calc('{32} + {35}').format('$')
    spreadsheet.select('H38:J38').calc('{32} + {35}').format('$')
    spreadsheet.select('B39:F39').calc('{38} / {27}').format('%')
    spreadsheet.select('H39:J39').calc('{38} / {27}').format('%')

    //// projected ebit inputs
      spreadsheet.select('L39:P39').insert(proj_ebit_margin).editable().format('%')
      spreadsheet.select('L38').calc('{L27} * {L39}').format('$')
      spreadsheet.select('M38').calc('{M27} * {M39}').format('$')
      spreadsheet.select('N38').calc('{N27} * {N39}').format('$')
      spreadsheet.select('O38').calc('{O27} * {O39}').format('$')
      spreadsheet.select('P38').calc('{P27} * {P39}').format('$')

    // d&a
    spreadsheet.select('B41:I41').insert(hist_da_fin).format('#')
    spreadsheet.select('J41').calc('{F} + {I} - {H}').format('#')

    //// projected d&a
      spreadsheet.select('L41:P41').calc('{104}').format('#')

    // ebitda
    spreadsheet.select('B43:F43').calc('{38} + {41}').format('$')
    spreadsheet.select('H43:J43').calc('{38} + {41}').format('$')
    spreadsheet.select('B44:F44').calc('{43} / {27}').format('%')
    spreadsheet.select('H44:J44').calc('{43} / {27}').format('%')

    //// projected ebitda calc
    spreadsheet.select('L43:P43').calc('{38} + {41}').format('$')
    spreadsheet.select('L44:P44').calc('{43} / {27}').format('%')

    // capex
    spreadsheet.select('B46:I46').insert(hist_capex_fin).format('#')
    spreadsheet.select('J46').calc('{F} + {I} - {H}').format('#')

    spreadsheet.select('B47:F47').calc('{46} / {27}').format('%')
    spreadsheet.select('H47:J47').calc('{46} / {27}').format('%')

    //// projected capex inputs
      spreadsheet.select('L47:P47').insert(proj_capex_margin).editable().format('%')
      spreadsheet.select('L46').calc('{L27} * {L47}').format('#')
      spreadsheet.select('M46').calc('{M27} * {M47}').format('#')
      spreadsheet.select('N46').calc('{N27} * {N47}').format('#')
      spreadsheet.select('O46').calc('{O27} * {O47}').format('#')
      spreadsheet.select('P46').calc('{P27} * {P47}').format('#')

// ***************************************************************
// Calculation Details and Methodology
// ***************************************************************

  // financial statement assumptions
    spreadsheet.select('A66:A151').addClass('headers')
      .insert(['',
               '',
               'Calculation Details and Methodology',
               'Financial Statement Analysis',
               '',
               '',
               'Implied Forecast',
               '',
               'Total Revenue',
               'COGS + SG&A Expenses',
               'EBIT',
               'Interest Expense',
               'EBT',
               'Pro forma Tax Expense',
               'Adjusted Net Income',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               '',
               'Discounted Cash Flow Analysis',
               'Implied Forecast',
               'EBIT',
               '  (-) Pro forma Tax Expense',
               'NOPAT',
               '  (+) D&A',
               '  (-) Investment in Working Capital',
               '  (-) Capital Expenditures',
               'Unlevered Free Cash Flow',
               '',
               'DCF Periods',
               'Discount Factor (Middle of Period)',
               'Discount Factor (End of Period)',
               'Discount Factor - Cost of Equity',
               '',
               'Fair Value per Share Reconcilation',
               '',
               '',
               '',
               'PV of Discrete Cash Flow',
               'PV of Terminal Cash Flow',
               'Enterprise Value',
               '  (+) Unconsolidated Investments',
               '  (+) Deferred Revenue Adj',
               '  (+/-) Other',
               '  (-) Non-controlling Interests',
               '  (-) Debt',
               '  (+) Cash',
               'Equity Value',
               '  (x) Diluted Shares Outstanding',
               'Fair Value per Share',
               '',
               'Supplemental Schedules',
               '',
               'Average Net Working Capital',
               '   % of Revenue',
               '   Excess / (Deficit)',
               '',
               'NOL: Unlevered Capital Structure',
               '',
               'NOL Beginning Balance',
               '   (+) Additions',
               '   (-) Usage',
               'NOL Ending Balance',
               '',
               '',
               'Depreciation Schedule',
               'Depreciation',
               'Amortization',
               '',
               'PP&E'])
    
    spreadsheet.select('J51').insert(valuation_date)
    spreadsheet.select('J53').insert('EBITDA Multiple')
    spreadsheet.select('L53').insert('Revenue Multiple')
    spreadsheet.select('M53').insert('Terminal Growth Rate')
    spreadsheet.select('N53').insert('EBIT Multiple')

    spreadsheet.select('J55:N55').insert(['Y', '', 'Y', 'Y', 'Y']).editable()
    spreadsheet.select('J57').insert([EBITDA_exit]).editable().format('##')
    spreadsheet.select('L57').insert([rev_exit]).editable()
    spreadsheet.select('M57').insert([growth_exit]).format('%').editable()
    spreadsheet.select('N57').insert([pe_exit]).editable().format('##')

    spreadsheet.select('J58').insert(discount_rate).editable().format('%')
    spreadsheet.select('L58:M58').calc('{J58}').format('%')
    spreadsheet.select('N58').insert(discount_rate).editable().format('%')


    spreadsheet.select('J59').calc('{J129}').format('$$')
    spreadsheet.select('L59:N59').calc('{129}').format('$$')

    spreadsheet.select('J60').insert([trading_price]).format('$$')
    spreadsheet.select('L60:N60').calc('{J60}').format('$$')

    spreadsheet.select('J61').calc('{J59} / {J60} - 1').format('%')
    spreadsheet.select('L61:N61').calc('{59} / {60} - 1').format('%')
    spreadsheet.select('J62').calc('({J61} + {L61} + {M61} + {N61})/4').format('%')

    spreadsheet.select('J64:L64').merge().calc('{J62} > .15 ? "BUY" : ({J62} < -.15 ? "SELL" : "HOLD")').addClass('rating')

    // titles
    // merged rows
    spreadsheet.select('L70:P70').merge().insert(['Implied Projection']).addClass('col-merge')

      // text date format entered
    spreadsheet.select('H71:J71').insert([hist_text_dates[7], hist_text_dates[7], 'Rest of'])
    spreadsheet.select('L71:P71').insert(proj_text_dates)

      // text period format entered
    spreadsheet.select('H72:J72').insert([hist_period_text_dates[8], hist_period_text_dates[7], proj_period_text_dates[0]])
    spreadsheet.select('L72:P72').insert(proj_period_text_dates)

    // additional inputs
    spreadsheet.select('F74').insert('Current Debt')
    spreadsheet.select('F75').insert(debt).editable().format('$')

    spreadsheet.select('F76').insert('Interest Rate')
    spreadsheet.select('F77').insert(interest_rate).editable().format('%')

    // ltm column
    spreadsheet.select('H74').calc('{J27}').format('$')
    spreadsheet.select('H75').calc('{76} - {74}').format('#')
    spreadsheet.select('H76').calc('{J38}').format('#')
    ///// spreadsheet.select('H77').insert(ltm_interest_exp).format('#')
    ///// spreadsheet.select('H78').calc('{H76} + {H77}').format('#')
    ///// spreadsheet.select('H79').calc('-(Math.max({H78} * {F102}, 0))').format('#')
    ///// spreadsheet.select('H80').calc('{H78} + {H79}').format('$')

    // ytd column
    spreadsheet.select('I74').calc('{I27}').format('$')
    spreadsheet.select('I75').calc('{76} - {74}').format('#')
    spreadsheet.select('I76').calc('{38}').format('#')
    ///// spreadsheet.select('I77').insert(ytd_interest_exp).format('#')
    ///// spreadsheet.select('I78').calc('{I76} + {I77}').format('#')
    ///// spreadsheet.select('I79').calc('-(Math.max({I78} * {F102}, 0))').format('#')

    // rest of year
    spreadsheet.select('J74').calc('{L} - {I}').format('$')
    spreadsheet.select('J75:J78').calc('{L} - {I}').format('#')
    // spreadsheet.select('J79').calc('-Math.max(({J78}+{L95})*{F102},0)').format('#')
    // spreadsheet.select('J80').calc('{78} + {79}').format('$')


    // five year projections
    spreadsheet.select('L74:P74').calc('{27}').format('$')
    spreadsheet.select('L75:P75').calc('{76} - {74}').format('#')
    spreadsheet.select('L76:P76').calc('{38}').format('#')
    // spreadsheet.select('L77:P77').calc('-{F77} * {F75}').format('#')
    // spreadsheet.select('L78:P78').calc('{76} + {77}').format('#')    
    // spreadsheet.select('L79').calc('{I79} + {J79}').format('#')
    // spreadsheet.select('M79:P79').calc('-Math.max(({78}+{95})*{F102},0)').format('#')
    
    // spreadsheet.select('L82:P82').calc('{133}').format('$')
    // spreadsheet.select('L83:P83').calc('{134}').format('%')

    // // Actual NOL
    // spreadsheet.select('J96').insert([0])
    // // - begining balances
    // spreadsheet.select('L93').calc('{J96}')
    // spreadsheet.select('M93').calc('{L96}')
    // spreadsheet.select('N93').calc('{M96}')
    // spreadsheet.select('O93').calc('{N96}')
    // spreadsheet.select('P93').calc('{O96}')

    // // - additions balances
    // spreadsheet.select('L94').calc('-Math.min(0,{J78})').format('#')
    // spreadsheet.select('M94').calc('-Math.min(0,{M78})').format('#')
    // spreadsheet.select('N94').calc('-Math.min(0,{N78})').format('#')
    // spreadsheet.select('O94').calc('-Math.min(0,{O78})').format('#')
    // spreadsheet.select('P94').calc('-Math.min(0,{P78})').format('#')

    // // - usaage balances
    // spreadsheet.select('L95').calc('-Math.max(0, Math.min({L93}, {J78}))')
    // spreadsheet.select('M95').calc('-Math.max(0, Math.min({M93}, {M78}))')
    // spreadsheet.select('N95').calc('-Math.max(0, Math.min({N93}, {N78}))')
    // spreadsheet.select('O95').calc('-Math.max(0, Math.min({O93}, {O78}))')
    // spreadsheet.select('P95').calc('-Math.max(0, Math.min({P93}, {P78}))')


    // // - ending balances
    // spreadsheet.select('J96').insert(0)
    // spreadsheet.select('L96').calc('{L93} + {L94} + {L95}')
    // spreadsheet.select('M96').calc('{M93} + {M94} + {M95}')
    // spreadsheet.select('N96').calc('{N93} + {N94} + {N95}')
    // spreadsheet.select('O96').calc('{O93} + {O94} + {O95}')
    // spreadsheet.select('P96').calc('{P93} + {P94} + {P95}')

    // spreadsheet.select('I80').calc('{I78} + {I79}').format('$')
    // spreadsheet.select('L80:P80').calc('{78} + {79}').format('$')



    // titles
    // merged rows
      // text date format entered
    // spreadsheet.select('H99:J99').insert([hist_text_dates[7], hist_text_dates[7], 'Rest of'])
    // spreadsheet.select('L99:Q99').insert(proj_text_dates.concat(['Terminal']))

      // text period format entered
    // spreadsheet.select('H100:J100').insert([hist_period_text_dates[8], hist_period_text_dates[7], proj_period_text_dates[0]])
    

    // spreadsheet.select('L100:Q100').insert(proj_period_text_dates.concat(['Cash Flow']))
    spreadsheet.select('Q100').insert('Cash Flow')

    spreadsheet.select('F101').insert('Tax Rate')
    spreadsheet.select('F102').insert(tax_rate).editable().format('%')

    spreadsheet.select('H101:I101').calc('{76}').format('$')
    spreadsheet.select('H102:I102').calc('-Math.max({101}*{F102},0)').format('#')
    spreadsheet.select('H103:I103').calc('{76} + {102}').format('$')
    spreadsheet.select('I104').calc('{I41}').format('#')
    spreadsheet.select('I105').calc('{I133}-{J133}').format('#')
    spreadsheet.select('I106').calc('-{I46}').format('#')
    spreadsheet.select('J101').calc('{L} - {I}').format('#')
    spreadsheet.select('J102').calc('-Math.max(({J101}+{L141})*{F102},0)').format('#')
    spreadsheet.select('J103:J107').calc('{L} - {I}').format('#')
    spreadsheet.select('L101:P101').calc('{76}').format('$')
    spreadsheet.select('L102').calc('{I102}+{J102}').format('#')
    spreadsheet.select('M102:P102').calc('-Math.max(({101}+{141})*{F102},0)').format('#')
    spreadsheet.select('L103:P103').calc('{101} + {102}').format('$')
    spreadsheet.select('L104:P104').calc('-({146} + {147})').format('#')
    spreadsheet.select('L105').calc('-({L133} - {I133})').format('#')
    spreadsheet.select('M105').calc('-({M133} - {L133})').format('#')
    spreadsheet.select('N105').calc('-({N133} - {M133})').format('#')
    spreadsheet.select('O105').calc('-({O133} - {N133})').format('#')
    spreadsheet.select('P105').calc('-({P133} - {O133})').format('#')
    spreadsheet.select('L106:P106').calc('-{46}').format('#')

    spreadsheet.select('Q101').calc('{P43} - {Q104}').format('$')
    spreadsheet.select('Q102').calc('-Math.max({Q101} * {F102}, 0)').format('#')
    spreadsheet.select('Q103').calc('{Q101} + {Q102}').format('$')
    spreadsheet.select('Q104').calc('-{Q106}*.9').format('#')
    spreadsheet.select('Q105').calc('-{P74}*{P83}+{P74}/(1+{M57})*{P83}').format('#')
    spreadsheet.select('Q106').calc('-{P74}*{P47}').format('#')

    spreadsheet.select('L107:Q107').calc('{103} + {104} + {105} + {106}').format('$')
    spreadsheet.select('I107').calc('{103} + {104} + {105} + {106}').format('$')

    // DCF Periods
    spreadsheet.select('L109').calc('(({L5} + {J5})/2 - ' + valuation_date + ')/365').format('##')
    spreadsheet.select('M109').calc('(({M5} + {L5})/2 - ' + valuation_date + ')/365').format('##')
    spreadsheet.select('N109').calc('(({N5} + {M5})/2 - ' + valuation_date + ')/365').format('##')
    spreadsheet.select('O109').calc('(({O5} + {N5})/2 - ' + valuation_date + ')/365').format('##')
    spreadsheet.select('P109').calc('(({P5} + {O5})/2 - ' + valuation_date + ')/365').format('##')

    // Discount Factors
    spreadsheet.select('L110').calc('1 / Math.pow((1 + {J58}),{L109})').format('%')
    spreadsheet.select('M110').calc('1 / Math.pow((1 + {J58}),{M109})').format('%')
    spreadsheet.select('N110').calc('1 / Math.pow((1 + {J58}),{N109})').format('%')
    spreadsheet.select('O110').calc('1 / Math.pow((1 + {J58}),{O109})').format('%')
    spreadsheet.select('P110').calc('1 / Math.pow((1 + {J58}),{P109})').format('%')

    spreadsheet.select('P111').calc('1 / Math.pow((1 + {J58}),(({P5}-{J5})/365))').format('%')
    spreadsheet.select('P112').calc('1 / Math.pow((1 + {N58}),(({P5}-{J5})/365))').format('%')


    // Fair value per share reconciliation
    spreadsheet.select('J116:N116').merge().insert(['Exit Method']).addClass('col-merge')
    spreadsheet.select('J117:N117').insert(['EBITDA Multiple', '', 'Revenue Multiple', 'Terminal Growth Rate', 'EBIT Multiple']).addClass('col-merge')
    
    // EBITDA Exit
    spreadsheet.select('J118').calc('{J107} * {L110} + {M107} * {M110} + {N107} * {N110} + {O107} * {O110} + {P107} * {P110}').format('#')
    spreadsheet.select('J119').calc('{J57}*{P43}*{P111}').format('#')
    spreadsheet.select('J120').calc('{J118} + {J119}').format('$')
    spreadsheet.select('J121:J126').insert(equity_waterfall).format('#')
    spreadsheet.select('J127').calc('Math.max({J120} + {J121} + {J122} + {J123} + {J124} + {J125} + {J126}, 0)').format('$')
    spreadsheet.select('J128').insert(shares_outstanding).format('#')
    spreadsheet.select('J129').calc('{J127} / {J128}').format('$$')


    // Revenue Exit
    spreadsheet.select('L118').calc('{J118}').format('#')
    spreadsheet.select('L119').calc('{L57}*{P27}*{P111}').format('#')
    spreadsheet.select('L120').calc('{L118} + {L119}').format('$')
    spreadsheet.select('L121:L126').insert(equity_waterfall).format('#')
    spreadsheet.select('L127').calc('Math.max({L120} + {L121} + {L122} + {L123} + {L124} + {L125} + {L126}, 0)').format('$')
    spreadsheet.select('L128').insert(shares_outstanding).format('#')
    spreadsheet.select('L129').calc('{L127} / {L128}').format('$$')


    // Terminal Growth Exit
    spreadsheet.select('M118').calc('{J118}').format('#')
    spreadsheet.select('M119').calc('{Q107}*(1+{M57})/({M58}-{M57})*{P111}+{P142}*{F102}*.2').format('#')
    spreadsheet.select('M120').calc('{M118} + {M119}').format('$')
    spreadsheet.select('M121:M126').insert(equity_waterfall).format('#')
    spreadsheet.select('M127').calc('Math.max({M120} + {M121} + {M122} + {M123} + {M124} + {M125} + {M126}, 0)').format('$')
    spreadsheet.select('M128').insert(shares_outstanding).format('#')
    spreadsheet.select('M129').calc('{M127} / {M128}').format('$$')


    // EBIT Exit
    spreadsheet.select('N118').calc('{J118}').format('#')    
    spreadsheet.select('N119').calc('{N57}*{P38}*{P111}').format('#')
    spreadsheet.select('N120').calc('{L118} + {L119}').format('$')
    spreadsheet.select('N121:N126').insert(equity_waterfall).format('#')
    spreadsheet.select('N127').calc('Math.max({N120} + {N121} + {N122} + {N123} + {N124} + {N125} + {N126}, 0)').format('$')
    spreadsheet.select('N128').insert(shares_outstanding).format('#')
    spreadsheet.select('N129').calc('{N127} / {N128}').format('$$')

      // text period format entered
    spreadsheet.select('I132:J132').insert([hist_period_text_dates[4],'Latest'])
    spreadsheet.select('L132:P132').insert(proj_period_text_dates)


    // Average Net Working Capital
    spreadsheet.select('I134').calc('{J134}').format('%')
    spreadsheet.select('J134').insert(avg_nwc).editable().format('%')
    spreadsheet.select('L134:P134').calc('{J134}').editable().format('%')

    spreadsheet.select('I133').calc('{F27}*{134}').format('$')
    spreadsheet.select('J133').calc('{27}*{134}').format('$')
    spreadsheet.select('L133:P133').calc('{27}*{134}').format('$')
    spreadsheet.select('J135').calc(latest_nwc + ' - {J133}').format('$')


    // DCF NOL
    spreadsheet.select('J142').insert([0])
    // - begining balances
    spreadsheet.select('L139').calc('{J142}')
    spreadsheet.select('M139').calc('{L142}')
    spreadsheet.select('N139').calc('{M142}')
    spreadsheet.select('O139').calc('{N142}')
    spreadsheet.select('P139').calc('{O142}')

    // - additions balances
    spreadsheet.select('L140').calc('-Math.min(0,{J101})').format('#')
    spreadsheet.select('M140').calc('-Math.min(0,{M101})').format('#')
    spreadsheet.select('N140').calc('-Math.min(0,{N101})').format('#')
    spreadsheet.select('O140').calc('-Math.min(0,{O101})').format('#')
    spreadsheet.select('P140').calc('-Math.min(0,{P101})').format('#')

    // - usaage balances
    spreadsheet.select('L141').calc('-Math.max(0, Math.min({L139}, {J101}))')
    spreadsheet.select('M141').calc('-Math.max(0, Math.min({M139}, {M101}))')
    spreadsheet.select('N141').calc('-Math.max(0, Math.min({N139}, {N101}))')
    spreadsheet.select('O141').calc('-Math.max(0, Math.min({O139}, {O101}))')
    spreadsheet.select('P141').calc('-Math.max(0, Math.min({P139}, {P101}))')


    // - ending balances
    spreadsheet.select('L142').calc('{L139} + {L140} + {L141}')
    spreadsheet.select('M142').calc('{M139} + {M140} + {M141}')
    spreadsheet.select('N142').calc('{N139} + {N140} + {N141}')
    spreadsheet.select('O142').calc('{O139} + {O140} + {O141}')
    spreadsheet.select('P142').calc('{P139} + {P140} + {P141}')

    spreadsheet.select('G, K').width(10).addClass('whiteout')
    spreadsheet.select('1, 2 ,5, 18, 29, 31, 34, 37, 40, 42, 45, 50').height(0).addClass('whiteout')
    spreadsheet.select('117').height(30)


    // depreciation schedule
    spreadsheet.select('F144').insert('Dep % of')
    spreadsheet.select('F145').insert('Prior PP&E')
    spreadsheet.select('F146').insert(dep_prior_ppe).editable().format('%')



    spreadsheet.select('H146:H147').insert(hist_ltm_da).format('#')
    spreadsheet.select('I146:I147').insert(hist_ytd_da).format('#')


    spreadsheet.select('F148').insert(hist_period_text_dates[4])
    spreadsheet.select('F149').insert(fy_ppe).format('$')
    
    spreadsheet.select('L146').calc('-{F146} * {F149}').format('#')
    spreadsheet.select('M146').calc('-{F146} * {L149}').format('#')
    spreadsheet.select('N146').calc('-{F146} * {M149}').format('#')
    spreadsheet.select('O146').calc('-{F146} * {N149}').format('#')
    spreadsheet.select('P146').calc('-{F146} * {O149}').format('#')

    spreadsheet.select('J146:J147').calc('{L} - {I}').format('#')

    spreadsheet.select('L147').insert(hist_ltm_da[1]).format('#')
    spreadsheet.select('M147:P147').calc('{H147}').format('#')

    spreadsheet.select('L149').calc('{L146} + {L46} + {F149}').format('$')
    spreadsheet.select('M149').calc('{M146} + {M46} + {L149}').format('$')
    spreadsheet.select('N149').calc('{N146} + {N46} + {M149}').format('$')
    spreadsheet.select('O149').calc('{O146} + {O46} + {N149}').format('$')
    spreadsheet.select('P149').calc('{P146} + {P46} + {O149}').format('$')



    // bold
    spreadsheet.select('6, B7:P7, 99, H100:Q100, 7, 9, 17, 19, 27, 32, 38, 43, 46, 49, 51, 53, 55, 59, 62, 64, 68, 70, 71, 72, 74, 76, 101, 103, 107, 120, 127, 129').addClass('totals')

    spreadsheet.select('A7, A49, A68').addClass('red-titles').addClass('titles')
    spreadsheet.select('A69, A98, A114, A131').addClass('red-titles')


    spreadsheet.select('F74, F76, F144, F145, F148, F101').addClass('input-heading')
    
    spreadsheet.select('J101, J103, J107').format('$')
    spreadsheet.select('H76:P76, H103:Q103, I107:Q107, J120:N120, J127:N127, J129:N129, J142:P142').addClass('total-border')
    
    spreadsheet.select('2:3').hide()
    
    // possible smaller row heights
    spreadsheet.select('5').hide()
    spreadsheet.select('9:26').hide()
    spreadsheet.select('30:37').hide()
    spreadsheet.select('69:98').hide('permanent-hide')
    //EBITDA & CAPEX
    spreadsheet.select('40:48').collapsible()

    //STOCK PRICE ANALYSIS
    spreadsheet.select('49:67').collapsible()

    //CALCULATIONS LIST
    spreadsheet.select('68:151').collapsible()

    //DCF
    spreadsheet.select('99:113').collapsible()

    //FAIR VALUE PER SHARE CALCULATION
    spreadsheet.select('114:130').collapsible()


    //SUPPLEMENTAL
    spreadsheet.select('131:151').collapsible()



    spreadsheet.select('A:E').collapsible()
    spreadsheet.select('G:I').collapsible()
    spreadsheet.select('Q').hide()


  </script>
</body>
</html>
