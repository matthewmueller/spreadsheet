(function(){function c(d,b,e){var a=c.resolve(d);if(null==a)throw e=e||d,b=b||"root",a=Error('Failed to require "'+e+'" from "'+b+'"'),a.path=e,a.parent=b,a.require=!0,a;b=c.modules[a];b._resolving||b.exports||(e={exports:{}},e.client=e.component=!0,b._resolving=!0,b.call(this,e.exports,c.relative(a),e),delete b._resolving,b.exports=e.exports);return b.exports}c.modules={};c.aliases={};c.resolve=function(d){"/"===d.charAt(0)&&(d=d.slice(1));for(var b=[d,d+".js",d+".json",d+"/index.js",d+"/index.json"],
e=0;e<b.length;e++){d=b[e];if(c.modules.hasOwnProperty(d))return d;if(c.aliases.hasOwnProperty(d))return c.aliases[d]}};c.normalize=function(d,b){var c=[];if("."!=b.charAt(0))return b;d=d.split("/");b=b.split("/");for(var a=0;a<b.length;++a)".."==b[a]?d.pop():"."!=b[a]&&""!=b[a]&&c.push(b[a]);return d.concat(c).join("/")};c.register=function(d,b){c.modules[d]=b};c.alias=function(d,b){if(!c.modules.hasOwnProperty(d))throw Error('Failed to alias "'+d+'", it does not exist');c.aliases[b]=d};c.relative=
function(d){function b(a){var f=b.resolve(a);return c(f,d,a)}var e=c.normalize(d,"..");b.resolve=function(a){var f=a.charAt(0);if("/"==f)return a.slice(1);if("."==f)return c.normalize(e,a);var f=d.split("/"),g;a:{for(g=f.length;g--;)if("deps"===f[g])break a;g=-1}(g+=1)||(g=0);return a=f.slice(0,g+1).join("/")+"/deps/"+a};b.exists=function(a){return c.modules.hasOwnProperty(b.resolve(a))};return b};c.register("component-domify/index.js",function(c,b,e){e.exports=function(f){if("string"!=typeof f)throw new TypeError("String expected");
var g=/<([\w:]+)/.exec(f);if(!g)throw Error("No elements were generated.");g=g[1];if("body"==g)return g=document.createElement("html"),g.innerHTML=f,g.removeChild(g.lastChild);var g=a[g]||a._default,b=g[0],l=g[1],h=g[2],g=document.createElement("div");for(g.innerHTML=l+f+h;b--;)g=g.lastChild;f=g.children;if(1==f.length)return g.removeChild(f[0]);for(b=document.createDocumentFragment();f.length;)b.appendChild(g.removeChild(f[0]));return b};var a={option:[1,'<select multiple="multiple">',"</select>"],
optgroup:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]}});c.register("component-emitter/index.js",
function(c,b,e){function a(b){if(b){for(var g in a.prototype)b[g]=a.prototype[g];return b}}e.exports=a;a.prototype.on=a.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};a.prototype.once=function(a,b){function c(){l.off(a,c);b.apply(this,arguments)}var l=this;this._callbacks=this._callbacks||{};c.fn=b;this.on(a,c);return this};a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=
function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var l,h=0;h<c.length;h++)if(l=c[h],l===b||l.fn===b){c.splice(h,1);break}return this};a.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c)for(var c=c.slice(0),l=0,h=c.length;l<h;++l)c[l].apply(this,b);return this};a.prototype.listeners=
function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};a.prototype.hasListeners=function(a){return!!this.listeners(a).length}});c.register("yields-isarray/index.js",function(c,b,e){var a=Object.prototype.toString;e.exports=Array.isArray||function(b){return!!b&&"[object Array]"==a.call(b)}});c.register("matthewmueller-extend/index.js",function(c,b,e){e.exports=function(a){for(var b=[].slice.call(arguments,1),g,c=0,l=b.length;c<l;c++){g=b[c];for(var h in g)a[h]=g[h]}return a}});
c.register("component-indexof/index.js",function(c,b,e){e.exports=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}});c.register("component-classes/index.js",function(c,b,e){function a(a){this.el=a;this.list=a.classList}var f=b("indexof"),g=/\s+/,q=Object.prototype.toString;e.exports=function(b){return new a(b)};a.prototype.add=function(a){if(this.list)return this.list.add(a),this;var b=this.array();~f(b,a)||b.push(a);this.el.className=b.join(" ");
return this};a.prototype.remove=function(a){if("[object RegExp]"==q.call(a))return this.removeMatching(a);if(this.list)return this.list.remove(a),this;var b=this.array();a=f(b,a);~a&&b.splice(a,1);this.el.className=b.join(" ");return this};a.prototype.removeMatching=function(a){for(var b=this.array(),c=0;c<b.length;c++)a.test(b[c])&&this.remove(b[c]);return this};a.prototype.toggle=function(a){if(this.list)return this.list.toggle(a),this;this.has(a)?this.remove(a):this.add(a);return this};a.prototype.array=
function(){var a=this.el.className.replace(/^\s+|\s+$/g,"").split(g);""===a[0]&&a.shift();return a};a.prototype.has=a.prototype.contains=function(a){return this.list?this.list.contains(a):!!~f(this.array(),a)}});c.register("component-query/index.js",function(c,b,e){function a(a,b){return b.querySelector(a)}c=e.exports=function(b,c){c=c||document;return a(b,c)};c.all=function(a,b){b=b||document;return b.querySelectorAll(a)};c.engine=function(b){if(!b.one)throw Error(".one callback required");if(!b.all)throw Error(".all callback required");
a=b.one;c.all=b.all}});c.register("component-matches-selector/index.js",function(c,b,e){var a=b("query");c=Element.prototype;var f=c.matches||c.webkitMatchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector;e.exports=function(b,c){if(f)return f.call(b,c);for(var l=a.all(c,b.parentNode),h=0;h<l.length;++h)if(l[h]==b)return!0;return!1}});c.register("component-delegate/index.js",function(c,b,e){var a=b("matches-selector"),f=b("event");c.bind=function(b,c,l,h,m){return f.bind(b,
l,function(b){a(b.target,c)&&h(b)},m)};c.unbind=function(a,b,c,h){f.unbind(a,b,c,h)}});c.register("component-events/index.js",function(c,b,e){function a(b,c){if(!(this instanceof a))return new a(b,c);if(!b)throw Error("element required");if(!c)throw Error("object required");this.el=b;this.obj=c;this._events={}}function f(a){a=a.split(/ +/);return{name:a.shift(),selector:a.join(" ")}}var g=b("event"),q=b("delegate");e.exports=a;a.prototype.sub=function(a,b,c){this._events[a]=this._events[a]||{};this._events[a][b]=
c};a.prototype.bind=function(a,b){function c(){var a=[].slice.call(arguments).concat(D);d[b].apply(d,a)}var k=f(a),e=this.el,d=this.obj,s=k.name;b=b||"on"+s;var D=[].slice.call(arguments,2);k.selector?c=q.bind(e,k.selector,s,c):g.bind(e,s,c);this.sub(s,b,c);return c};a.prototype.unbind=function(a,b){if(0==arguments.length)return this.unbindAll();if(1==arguments.length)return this.unbindAllOf(a);var c=this._events[a];c&&(c=c[b])&&g.unbind(this.el,a,c)};a.prototype.unbindAll=function(){for(var a in this._events)this.unbindAllOf(a)};
a.prototype.unbindAllOf=function(a){var b=this._events[a];if(b)for(var c in b)this.unbind(a,c)}});c.register("component-event/index.js",function(c,b,e){var a=window.addEventListener?"addEventListener":"attachEvent",f=window.removeEventListener?"removeEventListener":"detachEvent",g="addEventListener"!==a?"on":"";c.bind=function(b,c,f,e){b[a](g+c,f,e||!1);return f};c.unbind=function(a,b,c,e){a[f](g+b,c,e||!1);return c}});c.register("component-props/index.js",function(c,b,e){function a(a,b,c){return a.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g,
function(a){return"("==a[a.length-1]?c(a):~b.indexOf(a)?c(a):a})}function f(a){return function(b){return a+b}}var g=/\b(Array|Date|Object|Math|JSON)\b/g;e.exports=function(b,c){for(var e=b.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(g,"").match(/[a-zA-Z_]\w*/g)||[],d=[],k=0;k<e.length;k++)~d.indexOf(e[k])||d.push(e[k]);c&&"string"==typeof c&&(c=f(c));return c?a(b,d,c):d}});c.register("yields-uniq/index.js",function(c,b,e){try{var a=b("indexof")}catch(f){a=b("indexof-component")}e.exports=
function(b,c){var e=b.length,f=[],d;c=c?c instanceof Array?c:[c]:!1;for(var k=0;k<e;k++)d=b[k],c&&!~a(c,d)?f.push(d):~a(f,d)||f.push(d);return f}});c.register("adamwdraper-numeral-js/numeral.js",function(c,b,e){(function(){function a(a){this._value=a}function b(a,c,k,n){var e=Math.pow(10,c);a=(k(a*e)/e).toFixed(c);n&&(n=RegExp("0{1,"+n+"}$"),a=a.replace(n,""));return a}function c(a,p,e){var n=!1,g=!1,d=!1,h="",r=!1,l=!1,s=!1,q=!1,x=!1,y="",z="",w=Math.abs(a),B="B KB MB GB TB PB EB ZB YB".split(" "),
v="",A=!1;if(0===a&&null!==t)return t;-1<p.indexOf("(")?(n=!0,p=p.slice(1,-1)):-1<p.indexOf("+")&&(g=!0,p=p.replace(/\+/g,""));if(-1<p.indexOf("a"))if(r=0<=p.indexOf("aK"),l=0<=p.indexOf("aM"),s=0<=p.indexOf("aB"),q=0<=p.indexOf("aT"),x=r||l||s||q,-1<p.indexOf(" a")?(h=" ",p=p.replace(" a","")):p=p.replace("a",""),w>=Math.pow(10,12)&&!x||q)h+=m[k].abbreviations.trillion,a/=Math.pow(10,12);else if(w<Math.pow(10,12)&&w>=Math.pow(10,9)&&!x||s)h+=m[k].abbreviations.billion,a/=Math.pow(10,9);else if(w<
Math.pow(10,9)&&w>=Math.pow(10,6)&&!x||l)h+=m[k].abbreviations.million,a/=Math.pow(10,6);else if(w<Math.pow(10,6)&&w>=Math.pow(10,3)&&!x||r)h+=m[k].abbreviations.thousand,a/=Math.pow(10,3);if(-1<p.indexOf("b"))for(-1<p.indexOf(" b")?(y=" ",p=p.replace(" b","")):p=p.replace("b",""),s=0;s<=B.length;s++)if(r=Math.pow(1024,s),l=Math.pow(1024,s+1),a>=r&&a<l){y+=B[s];0<r&&(a/=r);break}-1<p.indexOf("o")&&(-1<p.indexOf(" o")?(z=" ",p=p.replace(" o","")):p=p.replace("o",""),z+=m[k].ordinal(a));-1<p.indexOf("[.]")&&
(d=!0,p=p.replace("[.]","."));a.toString().split(".");r=p.split(".")[1];B=p.indexOf(",");r?(-1<r.indexOf("[")?(r=r.replace("]",""),r=r.split("["),v=b(a,r[0].length+r[1].length,e,r[1].length)):v=b(a,r.length,e),a=v.split(".")[0],v=v.split(".")[1].length?m[k].delimiters.decimal+v.split(".")[1]:"",d&&0===Number(v.slice(1))&&(v="")):a=b(a,null,e);-1<a.indexOf("-")&&(a=a.slice(1),A=!0);-1<B&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+m[k].delimiters.thousands));0===p.indexOf(".")&&(a="");return(n&&
A?"(":"")+(!n&&A?"-":"")+(!A&&g?"+":"")+a+v+(z?z:"")+(h?h:"")+(y?y:"")+(n&&A?")":"")}function d(a){a=a.toString().split(".");return 2>a.length?1:Math.pow(10,a[1].length)}function l(){return Array.prototype.slice.call(arguments).reduce(function(a,b){var c=d(a),k=d(b);return c>k?c:k},-Infinity)}var h,m={},k="en",t=null,r="0,0",s="undefined"!==typeof e&&e.exports;h=function(b){h.isNumeral(b)?b=b.value():0===b||"undefined"===typeof b?b=0:Number(b)||(b=h.fn.unformat(b));return new a(Number(b))};h.version=
"1.5.3";h.isNumeral=function(b){return b instanceof a};h.language=function(a,b){if(!a)return k;if(a&&!b){if(!m[a])throw Error("Unknown language : "+a);k=a}if(b||!m[a])m[a]=b;return h};h.languageData=function(a){if(!a)return m[k];if(!m[a])throw Error("Unknown language : "+a);return m[a]};h.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":
"th"},currency:{symbol:"$"}});h.zeroFormat=function(a){t="string"===typeof a?a:null};h.defaultFormat=function(a){r="string"===typeof a?a:"0.0"};"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof a)throw new TypeError(a+" is not a function");var c,k,e=this.length>>>0,g=!1;1<arguments.length&&(k=b,g=!0);for(c=0;e>c;++c)this.hasOwnProperty(c)&&
(g?k=a(k,this[c],c,this):(k=this[c],g=!0));if(!g)throw new TypeError("Reduce of empty array with no initial value");return k});h.fn=a.prototype={clone:function(){return h(this)},format:function(a,b){var e=a?a:r,n=void 0!==b?b:Math.round;if(-1<e.indexOf("$")){var d=e,e=d.indexOf("$"),f=d.indexOf("("),h=d.indexOf("-"),t="";-1<d.indexOf(" $")?(t=" ",d=d.replace(" $","")):-1<d.indexOf("$ ")?(t=" ",d=d.replace("$ ","")):d=d.replace("$","");d=c(this._value,d,n);if(1>=e)if(-1<d.indexOf("(")||-1<d.indexOf("-")){d=
d.split("");n=1;if(e<f||e<h)n=0;d.splice(n,0,m[k].currency.symbol+t);d=d.join("")}else d=m[k].currency.symbol+t+d;else-1<d.indexOf(")")?(d=d.split(""),d.splice(-1,0,t+m[k].currency.symbol),d=d.join("")):d=d+t+m[k].currency.symbol;n=d}else-1<e.indexOf("%")?(f=e,e="",h=100*this._value,-1<f.indexOf(" %")?(e=" ",f=f.replace(" %","")):f=f.replace("%",""),n=c(h,f,n),-1<n.indexOf(")")?(n=n.split(""),n.splice(-1,0,e+"%"),n=n.join("")):n=n+e+"%"):-1<e.indexOf(":")?(n=Math.floor(this._value/60/60),e=Math.floor((this._value-
3600*n)/60),f=Math.round(this._value-3600*n-60*e),n=n+":"+(10>e?"0"+e:e)+":"+(10>f?"0"+f:f)):n=c(this._value,e,n);return n},unformat:function(a){if("[object Number]"===Object.prototype.toString.call(a))return a;var b=a=a?a:r,c,d,e,f,g="KB MB GB TB PB EB ZB YB".split(" "),h=!1,l;if(-1<a.indexOf(":"))a=a.split(":"),b=0,3===a.length?(b+=3600*Number(a[0]),b+=60*Number(a[1]),b+=Number(a[2])):2===a.length&&(b+=60*Number(a[0]),b+=Number(a[1])),this._value=Number(b);else if(a===t)this._value=0;else{"."!==
m[k].delimiters.decimal&&(a=a.replace(/\./g,"").replace(m[k].delimiters.decimal,"."));c=RegExp("[^a-zA-Z]"+m[k].abbreviations.thousand+"(?:\\)|(\\"+m[k].currency.symbol+")?(?:\\))?)?$");d=RegExp("[^a-zA-Z]"+m[k].abbreviations.million+"(?:\\)|(\\"+m[k].currency.symbol+")?(?:\\))?)?$");e=RegExp("[^a-zA-Z]"+m[k].abbreviations.billion+"(?:\\)|(\\"+m[k].currency.symbol+")?(?:\\))?)?$");f=RegExp("[^a-zA-Z]"+m[k].abbreviations.trillion+"(?:\\)|(\\"+m[k].currency.symbol+")?(?:\\))?)?$");for(l=0;l<=g.length&&
!(h=-1<a.indexOf(g[l])?Math.pow(1024,l+1):!1);l++);this._value=(h?h:1)*(b.match(c)?Math.pow(10,3):1)*(b.match(d)?Math.pow(10,6):1)*(b.match(e)?Math.pow(10,9):1)*(b.match(f)?Math.pow(10,12):1)*(-1<a.indexOf("%")?0.01:1)*((a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1)*Number(a.replace(/[^0-9\.]+/g,""));this._value=h?Math.ceil(this._value):this._value}return this._value},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){this._value=
Number(a);return this},add:function(a){var b=l.call(null,this._value,a);this._value=[this._value,a].reduce(function(a,c,k,d){return a+b*c},0)/b;return this},subtract:function(a){var b=l.call(null,this._value,a);this._value=[a].reduce(function(a,c,k,d){return a-b*c},this._value*b)/b;return this},multiply:function(a){this._value=[this._value,a].reduce(function(a,b,c,k){c=l(a,b);return a*c*b*c/(c*c)},1);return this},divide:function(a){this._value=[this._value,a].reduce(function(a,b,c,k){c=l(a,b);return a*
c/(b*c)});return this},difference:function(a){return Math.abs(h(this._value).subtract(a).value())}};s&&(e.exports=h);"undefined"===typeof ender&&(this.numeral=h);"function"===typeof define&&define.amd&&define([],function(){return h})}).call(this)});c.register("spreadsheet/lib/spreadsheet.js",function(c,b,e){function a(){if(!(this instanceof a))return new a;this.el=s.cloneNode();this.spreadsheet={};this.events=g(this.el,this)}var f=b("classes");b("event");var g=b("events");b("isArray");c=b("emitter");
b("extend");var q=b("domify"),l=b("./selection"),h=b("./cell"),m=b("./utils"),k=b("./match"),t=m.lton,r=m.ntol,s=q('<table class="spreadsheet"></table>');e.exports=a;c(a.prototype);a.prototype.select=function(a){return new l(a,this)};a.prototype.insert=function(a,b){var c={},k;"string"==typeof a?c[a]=b:c=a;for(a in c)b=c[a],a=a.toUpperCase(),b=b instanceof h?b:new h(b,a,this),k=this.find(a),k||(this.fill(a),k=this.find(a)),k.textContent="",k.appendChild(b.render()),this.spreadsheet[a]=b;return this};
a.prototype.fill=function(a){var b=this.spreadsheet,c=this.el,d=k(a);a=t(d[1]);for(var e=+d[2],f=c.getElementsByTagName("tr")[e-1],f=this.largest(),d=k(f),f=t(d[1]),d=+d[2],e=d>e?d:e,g=f>a?f:a,l=c.getElementsByTagName("tr"),m=1;m<=e;m++){f=l[m-1];f||(f=document.createElement("tr"),f.setAttribute("name",m),c.appendChild(f));tds=f.getElementsByTagName("td");for(var s=0;s<=g;s++)td=tds[s],td||(a=r(s)+m,d=new h(null,a,this),b[a]=d,td=document.createElement("td"),td.setAttribute("name",a),td.appendChild(d.render()),
f.appendChild(td))}};a.prototype.border=function(a,b,c){return this};a.prototype.onblur=function(a){f(a.target.parentNode).remove("active")};a.prototype.at=function(a){a=a.toUpperCase();return this.spreadsheet[a]||null};a.prototype.largest=function(){var a=this.el.querySelector("tr:last-child");return a?(a=a.querySelector("td:last-child"))?a.getAttribute("name"):"A1":"A1"};a.prototype.find=function(a){return this.el.querySelector('td[name="'+a+'"]')}});c.register("spreadsheet/lib/selection.js",function(c,
b,e){function a(b,c){if(!(this instanceof a))return new a(b,c);this.spreadsheet=c;this.expr=b;this.selection=h(b,c.largest())}var f=[].slice,g=b("isArray"),q=b("./cell");b("./type");var l=b("./tokens"),h=b("./expand"),m=b("./utils").shift;e.exports=a;a.prototype.insert=function(a){a=g(a)?a:[a];this.each(function(b,c){b.val(void 0==a[c]?"":a[c])});return this};a.prototype.calc=function(a){var b=l(a);this.each(function(c){for(var d=a,e=0,f;f=b[e];e++)var g=m(c.at,f),d=d.replace(f,g);c.val("= "+d)});
return this};a.prototype.editable=function(){return this.each("editable")};a.prototype.format=function(a){return this.each("format",a)};a.prototype.addClass=function(a){return this.each("addClass",a)};a.prototype.each=function(a){for(var b=this.spreadsheet,c=f.call(arguments,1),d="function"==typeof a,e=this.selection,g,h=0;g=e[h];h++)g=b.at(g)||new q(null,g,b),d?a(g,h):g[a].apply(g,c);return this};a.prototype.select=function(b){return new a(b,this.spreadsheet)}});c.register("spreadsheet/lib/cell.js",
function(c,b,e){function a(b,c,d){if(!(this instanceof a))return new a(b,c,d);this.at=c;this.value=b;this.spreadsheet=d;this.el=m.cloneNode();this.el.value=b;this.classes=q(this.el);this.formatting=this.expr=!1;this.observing=[]}var f=b("numeral"),g=b("event");b("emitter");c=b("domify");var q=b("classes");b("props");b("./type");var l=b("./tokens"),h=/\s*=/,m=c('<input type="text" disabled>');e.exports=a;a.prototype.val=function(a,b){if(void 0==a)return this.compute(this.value,b);b=b||{};b.compute=
void 0==b.compute?!0:b.compute;var c=this.spreadsheet,d=this.value,e=this.at;null==a||c.at(e)||c.insert(e,this);this.el.value=b.compute?this.compute(a):a;this.value=a;b.silent||c.emit("change "+e,a,d,this);return this};a.prototype.compute=function(a,b){b=b||{};var c=void 0==b.format?!0:b.format;h.test(a)?this.expr=this.expr&&this.value==a?this.expr:this.compile(a):this.expr=!1;a=this.expr?this.expr():a;c&&(c=this.formatting)&&(c=a,c=!isNaN(parseFloat(c))&&isFinite(c));return a=c?f(a).format(this.formatting):
a};a.prototype.compile=function(a,b){var c=l(a),d=RegExp(c.join("|"),"g");a=a.replace(h,"");if(!a)return a;a=a.replace(d,"_.$&");a=new Function("_","return "+a);this.observe(c);return function(){for(var b={},d,e=0,f=c.length;e<f;e++)d=+spreadsheet.at(c[e]).val(null,{format:!1}),d=isNaN(d)?0:d,b[c[e]]=d;return a(b)}};a.prototype.format=function(a){this.formatting="%"==a?"0 %":"$"==a?"($ 0,0.00)":a;this.val(this.value);return this};a.prototype.render=function(){return this.el};a.prototype.editable=
function(){var a=this,b=this.el;this.classes.add("editable");b.removeAttribute("disabled");g.bind(b,"input",function(c){h.test(b.value)||a.val(b.value,{compute:!1})});g.bind(b,"focus",function(c){(c=b.parentNode)&&q(c).add("active");b.value=a.value});g.bind(b,"blur",function(c){(c=b.parentNode)&&q(c).remove("active");""!=b.value&&a.val(b.value)});return this};a.prototype.addClass=function(a){q(this.el.parentNode).add(a)};a.prototype.observe=function(a){function b(a,d,e){c.val(c.value)}var c=this,
d=this.spreadsheet;this.observing.length&&console.log("TODO: remove observed");for(var e=0,f;f=a[e];e++)d.on("change "+f,b),this.observing.push([f,b])};a.prototype.rowspan=function(){};a.prototype.colspan=function(){}});c.register("spreadsheet/lib/utils.js",function(c,b,e){var a=b("./type");c.lton=function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a)};c.ntol=function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZ"[a]};c.shift=function(b,c){var d=a(c);c=c.replace(/^\:/,"");switch(d){case "col":return b.replace(/[A-Za-z]+/g,
c);case "row":return b.replace(/[0-9]+/g,c);case "cell":return c}}});c.register("spreadsheet/lib/type.js",function(c,b,e){function a(a){if(f.block.test(a))return"block";if(f.cell.test(a))return"cell";if(f.row.test(a))return"row";if(f.col.test(a))return"col"}var f=b("./regex");e.exports=function(b){return a(b)}});c.register("spreadsheet/lib/tokens.js",function(c,b,e){var a=b("./regex");e.exports=function(b){var c=[];b.replace(a.any,function(a){c.push(a)});return c}});c.register("spreadsheet/lib/regex.js",
function(c,b,e){b=c.block=/([A-Za-z]+[0-9]+)\:([A-Za-z]+[0-9]+)/;e=c.cell=/([A-Za-z]+)([0-9]+)/;var a=c.col=/\:([A-Za-z]+)/,f=c.row=/\:([0-9]+)/;c.any=RegExp([b,e,a,f].map(function(a){return a.source}).join("|"),"g")});c.register("spreadsheet/lib/expand.js",function(c,b,e){function a(a,b){var c=m.exec(a);if(!c)return this.error("invalid expansion: "+a);var e=q(c[1]),d=+c[2],f=m.exec(b);if(!f)return this.error("invalid expansion: "+b);for(var c=q(f[1]),f=+f[2],g=[];d<=f;d++)for(var h=e;h<=c;h++)g[g.length]=
l(h)+d;return g}var f=b("./tokens"),g=b("./type");c=b("./utils");var q=c.lton,l=c.ntol;b=b("./regex");var h=b.block,m=b.cell,k=b.row,t=b.col;e.exports=function(b,c){for(var e=f(b),d=m.exec(c),l=d[1],n=d[2],q=[],C=0;d=e[C];C++)switch(g(d)){case "block":d=h.exec(d);q=q.concat(a(d[1],d[2]));break;case "row":var d=k.exec(d),u=+d[1],d="A"+u,u=l+u,q=q.concat(a(d,u));break;case "col":d=t.exec(d);u=d[1];d=u+1;u+=n;q=q.concat(a(d,u));break;case "cell":q=q.concat(d)}return q}});c.register("spreadsheet/lib/match.js",
function(c,b,e){var a=b("./regex");e.exports=function(b){return b.match(a.block)||b.match(a.row)||b.match(a.col)||b.match(a.cell)}});c.alias("component-domify/index.js","spreadsheet/deps/domify/index.js");c.alias("component-domify/index.js","domify/index.js");c.alias("component-emitter/index.js","spreadsheet/deps/emitter/index.js");c.alias("component-emitter/index.js","emitter/index.js");c.alias("yields-isarray/index.js","spreadsheet/deps/isArray/index.js");c.alias("yields-isarray/index.js","isArray/index.js");
c.alias("matthewmueller-extend/index.js","spreadsheet/deps/extend/index.js");c.alias("matthewmueller-extend/index.js","spreadsheet/deps/extend/index.js");c.alias("matthewmueller-extend/index.js","extend/index.js");c.alias("matthewmueller-extend/index.js","matthewmueller-extend/index.js");c.alias("component-classes/index.js","spreadsheet/deps/classes/index.js");c.alias("component-classes/index.js","classes/index.js");c.alias("component-indexof/index.js","component-classes/deps/indexof/index.js");c.alias("component-events/index.js",
"spreadsheet/deps/events/index.js");c.alias("component-events/index.js","events/index.js");c.alias("component-event/index.js","component-events/deps/event/index.js");c.alias("component-delegate/index.js","component-events/deps/delegate/index.js");c.alias("component-matches-selector/index.js","component-delegate/deps/matches-selector/index.js");c.alias("component-query/index.js","component-matches-selector/deps/query/index.js");c.alias("component-event/index.js","component-delegate/deps/event/index.js");
c.alias("component-event/index.js","spreadsheet/deps/event/index.js");c.alias("component-event/index.js","event/index.js");c.alias("component-props/index.js","spreadsheet/deps/props/index.js");c.alias("component-props/index.js","spreadsheet/deps/props/index.js");c.alias("component-props/index.js","props/index.js");c.alias("component-props/index.js","component-props/index.js");c.alias("yields-uniq/index.js","spreadsheet/deps/uniq/index.js");c.alias("yields-uniq/index.js","uniq/index.js");c.alias("component-indexof/index.js",
"yields-uniq/deps/indexof/index.js");c.alias("adamwdraper-numeral-js/numeral.js","spreadsheet/deps/numeral/numeral.js");c.alias("adamwdraper-numeral-js/numeral.js","spreadsheet/deps/numeral/index.js");c.alias("adamwdraper-numeral-js/numeral.js","numeral/index.js");c.alias("adamwdraper-numeral-js/numeral.js","adamwdraper-numeral-js/index.js");c.alias("spreadsheet/lib/spreadsheet.js","spreadsheet/index.js");"object"==typeof exports?module.exports=c("spreadsheet"):"function"==typeof define&&define.amd?
define([],function(){return c("spreadsheet")}):this.spreadsheet=c("spreadsheet")})();
